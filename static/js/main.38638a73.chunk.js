(this.webpackJsonpmultimap=this.webpackJsonpmultimap||[]).push([[0],[,,,,,,,,,,,function(e,t,c){},function(e,t,c){},function(e,t,c){},,function(e,t,c){},,,function(e,t,c){},function(e,t,c){"use strict";c.r(t);var s=c(2),n=c.n(s),o=c(4),l=c.n(o),a=(c(11),c(3)),i=c.n(a),r=(c(12),c(13),c(0));const d=({menuState:e,toggle:t})=>Object(r.jsxs)("div",{id:"hamburger",className:e,onClick:t,children:[Object(r.jsx)("span",{}),Object(r.jsx)("span",{}),Object(r.jsx)("span",{}),Object(r.jsx)("span",{})]}),j=({menuState:e,paintPlace:t,places:c,toggle:s})=>{const n={height:("open"===e?26*c.length-18+18:0)+"px",padding:"0px 6px 0px 6px"},o={paddingTop:"18px"};return Object(r.jsx)("div",{id:"places",className:e,style:n,children:Object(r.jsx)("ol",{style:o,children:c.map((({disp:e,id:c})=>Object(r.jsx)("div",{children:Object(r.jsx)(p,{paintPlace:t,closeMenu:s,disp:e,id:c})},c)))})})},p=({paintPlace:e,closeMenu:t,disp:c,id:n})=>{const[o,l]=Object(s.useState)("unloaded");return Object(r.jsx)("li",{id:n,className:o,style:{fontSize:"14px"},onClick:function(){e(n).then((()=>{l("loaded"),t()}))},children:c})};var m=({paintPlace:e,places:t})=>{const[c,n]=Object(s.useState)("loading");function o(){n("open"===c?"closed":"open")}return"loading"===c&&t.length>0&&n("open"),Object(r.jsxs)("div",{id:"menu",className:c,children:[Object(r.jsx)(d,{menuState:c,toggle:o}),Object(r.jsx)(j,{menuState:c,paintPlace:e,places:t,toggle:o})]})};c(15);const b=({color:e})=>Object(r.jsx)("svg",{width:"35px",children:Object(r.jsx)("circle",{r:"5",cx:"13",cy:"13",fill:e})}),u=({color:e})=>Object(r.jsx)("svg",{width:"35px",children:Object(r.jsx)("line",{x1:"0",x2:"25",y1:"13",y2:"13",stroke:e})});var h=({visible:e,colorRiver:t,colorTrack:c})=>e?Object(r.jsxs)("div",{id:"legend",children:[Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)("div",{id:"eg-aud",className:"eg-marker"}),Object(r.jsx)("span",{children:"sound"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)("div",{id:"eg-img",className:"eg-marker"}),Object(r.jsx)("span",{children:"photo"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)(b,{color:t}),Object(r.jsx)("span",{children:"water feature"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)(b,{color:c}),Object(r.jsx)("span",{children:"human feature"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)(b,{color:"#000000"}),Object(r.jsx)("span",{children:"other feature"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)(u,{color:t}),Object(r.jsx)("span",{children:"river"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)(u,{color:c}),Object(r.jsx)("span",{children:"my route"})]})]}):Object(r.jsx)("div",{});let x=c(6);const O=e=>`https://s3-us-west-2.amazonaws.com/multimap-2/gps/s3/${e}?rev=${(new Date).getTime()}`;let g={};const v=e=>fetch(O(`${e}.json`)).then((t=>t.ok?t.json():Promise.reject(`Unable to fetch ${e}.json`))),f=(e,t)=>c=>fetch(O(`${e}/geojson/${c}`)).then((e=>e.json())).then(t(c));c(17),c(18);const y=e=>{let t=document.createElement("div");return null!=e.aud?t.className="marker-aud":null!=e.img?t.className="marker-img":t.className="marker-pt",t},w=e=>{let t=e.target._content||document.getElementsByClassName("mapboxgl-popup-content")[0];if(null!=t){let e=window.innerWidth/2-t.clientWidth/2;t.style=`transform:translate(${e}px, 0px)`}},N=({place:e,location:t})=>{const c=t.img?O(`${e}/imgLg/${t.img}`):null,s=t.img?O(`${e}/imgSm/${t.img}`):null,n=t.label||"";return Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:"labels",children:[Object(r.jsx)(k,{location:t}),Object(r.jsx)($,{date:t.date})]}),Object(r.jsx)("div",{className:"center",children:Object(r.jsx)("h3",{children:n})}),Object(r.jsx)(S,{srcLg:c,srcSm:s,label:n}),Object(r.jsx)(C,{place:e,src:t.aud})]})},k=({location:e})=>{const t=e.loc.lat.toFixed(4),c=e.loc.lng.toFixed(4),s=`https://www.google.com/maps/search/?api=1&query=${e.loc.lat},${e.loc.lng}`;return Object(r.jsxs)("div",{className:"loc",children:[Object(r.jsxs)("div",{className:"icon link",children:[Object(r.jsx)("span",{className:"material-icons",children:"map"}),Object(r.jsxs)("a",{href:s,target:"_",children:[t,",",c]})]}),Object(r.jsx)("div",{className:"bordr"})]})},$=({date:e})=>null==e?Object(r.jsx)("div",{}):Object(r.jsxs)("div",{className:"icon",children:[Object(r.jsx)("span",{className:"material-icons",children:"schedule"}),e]}),S=({srcLg:e,srcSm:t,label:c})=>Object(r.jsx)("div",{className:"center",children:Object(r.jsx)("a",{id:"scroll",href:e,target:"_blank",rel:"noreferrer",children:Object(r.jsx)(P,{srcLg:e,srcSm:t,label:c})})}),P=({srcLg:e,srcSm:t,label:c})=>null==t||null==e?Object(r.jsx)("div",{}):Object(r.jsx)("img",{className:"bordr",src:t,href:e,alt:c}),C=({place:e,src:t})=>{if(null==t)return Object(r.jsx)("div",{});{const c=O(`${e}/aud/${t}`);return Object(r.jsxs)("audio",{controls:!0,children:[Object(r.jsx)("source",{src:c,type:"audio/mpeg"}),"Your browser does not support audio!"]})}},L=({paintPlace:e,setError:t},c)=>{let s=null;(s=c.split("#")[1])&&e(s).then((()=>{let e=null;(e=document.getElementById(s))&&(e.className="loaded",t(!1))}))};var E=e=>{L(e,window.location.hash),window.onhashchange=()=>{L(e,window.location.hash)}},z=e=>window.location.hash=e;let T=c(6);i.a.accessToken="pk.eyJ1IjoiZWRvYXJkc2Nob29uZXIiLCJhIjoiY2lxcHR0dG51MDJoZGZxbmhneTB0aW5oOSJ9.RX4c1qW-bwPCptphF_mr_A";const J="#00bcff",M="#ff2592",W=(e,t,c)=>s=>((e,t)=>null==g[e]?v(`${e}/info`).then((c=>(g[e]=c,x.each(c.layers,f(e,t)),Promise.resolve({json:c,paint:!0})))):Promise.resolve({json:g[e],paint:!1}))(s,_(e,s)).then((({json:c,paint:n})=>{A(e,c),n&&(R(e,s,c),t(s))})).catch((e=>c(!0))),A=(e,{zoom:t,locations:c,center:s})=>{const n=T.findWhere(c,{label:s}).loc;e.flyTo({center:[n.lng,n.lat],zoom:t})},R=(e,t,{locations:c})=>T.each(c,((e,t)=>c=>{const s=document.createElement("div");l.a.render(Object(r.jsx)(N,{place:t,location:c}),s);const n=new i.a.Popup({className:"media",closeOnClick:!0,offset:25}).setDOMContent(s);new i.a.Marker(y(c)).setLngLat([c.loc.lng,c.loc.lat]).setPopup(n).addTo(e),n.on("open",w),window.addEventListener("resize",w,!0)})(e,t)),_=(e,t)=>c=>s=>{const n=`layer-${t}-${c}`;e.addSource(n,{type:"geojson",data:s});const o=n.split("-");B(e,n,o),I(e,n,o),D(e,n)},B=(e,t,c)=>{const s=-1!==c.indexOf("cenote")||-1!==c.indexOf("river"),n=`${t}-points`;e.addLayer({id:n,type:"circle",source:t,paint:{"circle-radius":6,"circle-color":s?"#2592ff":"#ff2592"},filter:["==","$type","Point"]});const o=({features:t})=>{if(0===t.length)return;const c=t[0],s=document.createElement("div");s.textContent=c.properties.name;const o=new i.a.Popup({offset:[0,-15]}).setLngLat(c.geometry.coordinates).setDOMContent(s).addTo(e);s.parentNode.parentNode.className+=" tip",e.on("closeAllPopups",(()=>{o.remove()}));e.on("mouseleave",n,(()=>e.fire("closeAllPopups")))};e.on("mousemove",n,o),e.on("click",n,o)},I=(e,t,c)=>{const s=-1!==c.indexOf("track");e.addLayer({id:`${t}-lines`,type:"line",source:t,layout:{"line-join":"round","line-cap":"round"},paint:s?Z:F,filter:["==","$type","LineString"]})},D=(e,t)=>{e.addLayer({id:`${t}-polygons`,type:"fill",source:t,paint:{"fill-color":"#000000","fill-opacity":.2},filter:["==","$type","Polygon"]})},F={"line-color":J,"line-width":2},Z={"line-color":M,"line-width":2,"line-opacity":.6},q=({visible:e})=>e?Object(r.jsx)("div",{id:"center-message",children:Object(r.jsx)("div",{id:"message-container",children:Object(r.jsx)("div",{id:"message",children:"that place does not exist"})})}):Object(r.jsx)("div",{});var G=()=>{const e=Object(s.useRef)(null),[t,c]=Object(s.useState)(null),[n,o]=Object(s.useState)([]),[l,a]=Object(s.useState)(!1),[d,j]=Object(s.useState)(!1),p=e=>W(e,(e=>{j(!1),a(!0),z(e)}),(()=>j(!0)));return Object(s.useEffect)((()=>{const t=new i.a.Map({container:e.current,style:"mapbox://styles/edoardschooner/cku8yh0id5za818rmtnwt7zzo",attributionControl:!1,center:[-123.0561972,38.9144944],zoom:5}).addControl(new i.a.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})).addControl(new i.a.AttributionControl({compact:!0,customAttribution:"\xa9 Wes Jackson 2021 ~ Love and water are never wasted; they are the efflux of our inner nature"})).addControl(new i.a.FullscreenControl({container:document.querySelector("body")})).addControl(new i.a.NavigationControl,"top-right").once("load",(()=>v("all_rivers").then((({places:e})=>Promise.resolve(x.sortBy(e,"disp")))).then((e=>{o(e),c(t),E({paintPlace:p(t),setError:j})}))));return()=>t.remove()}),[]),Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{id:"my-controls",children:[Object(r.jsx)(m,{paintPlace:p(t),places:n}),Object(r.jsx)(h,{visible:l,colorRiver:J,colorTrack:M})]}),Object(r.jsx)(q,{visible:d}),Object(r.jsx)("div",{className:"map-container",ref:e})]})};var H=function(){return Object(r.jsx)("div",{children:Object(r.jsx)(G,{})})};l.a.render(Object(r.jsx)(n.a.StrictMode,{children:Object(r.jsx)(H,{})}),document.getElementById("root"))}],[[19,1,2]]]);
//# sourceMappingURL=main.38638a73.chunk.js.map