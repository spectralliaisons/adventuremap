(this.webpackJsonpmultimap=this.webpackJsonpmultimap||[]).push([[0],[,,,,,,,,,,,function(e,t,c){},function(e,t,c){},function(e,t,c){},,function(e,t,c){},,,function(e,t,c){},function(e,t,c){"use strict";c.r(t);var n=c(2),s=c.n(n),l=c(4),o=c.n(l),a=(c(11),c(3)),i=c.n(a),r=(c(12),c(13),c(0));const d=({menuState:e,toggle:t})=>Object(r.jsxs)("div",{id:"hamburger",className:e,onClick:t,children:[Object(r.jsx)("span",{}),Object(r.jsx)("span",{}),Object(r.jsx)("span",{}),Object(r.jsx)("span",{})]}),j=({menuState:e,paintPlace:t,places:c,toggle:n})=>{const s={height:("open"===e?26*c.length-18+18:0)+"px",padding:"0px 6px 0px 6px"},l={paddingTop:"18px"};return Object(r.jsx)("div",{id:"places",className:e,style:s,children:Object(r.jsx)("ol",{style:l,children:c.map((({disp:e,id:c})=>Object(r.jsx)("div",{children:Object(r.jsx)(p,{paintPlace:t,closeMenu:n,disp:e,id:c})},c)))})})},p=({paintPlace:e,closeMenu:t,disp:c,id:s})=>{const[l,o]=Object(n.useState)("unloaded");return Object(r.jsx)("li",{id:s,className:l,style:{fontSize:"14px"},onClick:function(){e(s).then((()=>{o("loaded"),t()}))},children:c})};var m=({paintPlace:e,places:t})=>{const[c,s]=Object(n.useState)("loading");function l(){s("open"===c?"closed":"open")}return"loading"===c&&t.length>0&&s("open"),Object(r.jsxs)("div",{id:"menu",className:c,children:[Object(r.jsx)(d,{menuState:c,toggle:l}),Object(r.jsx)(j,{menuState:c,paintPlace:e,places:t,toggle:l})]})};c(15);const u=({color:e})=>Object(r.jsx)("svg",{width:"35px",children:Object(r.jsx)("circle",{r:"5",cx:"13",cy:"13",fill:e})}),b=({color:e})=>Object(r.jsx)("svg",{width:"35px",children:Object(r.jsx)("line",{x1:"0",x2:"25",y1:"13",y2:"13",stroke:e})});var h=({visible:e,colorRiver:t,colorTrack:c})=>e?Object(r.jsxs)("div",{id:"legend",children:[Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)("div",{id:"eg-aud",className:"eg-marker"}),Object(r.jsx)("span",{children:"sound"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)("div",{id:"eg-img",className:"eg-marker"}),Object(r.jsx)("span",{children:"photo"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)(u,{color:t}),Object(r.jsx)("span",{children:"water feature"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)(u,{color:c}),Object(r.jsx)("span",{children:"human feature"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)(u,{color:"#000000"}),Object(r.jsx)("span",{children:"other feature"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)(b,{color:t}),Object(r.jsx)("span",{children:"river"})]}),Object(r.jsxs)("div",{className:"item",children:[Object(r.jsx)(b,{color:c}),Object(r.jsx)("span",{children:"my route"})]})]}):Object(r.jsx)("div",{});let x=c(6);const O=e=>`https://s3-us-west-2.amazonaws.com/multimap-2/gps/s3/${e}?rev=${(new Date).getTime()}`;let g={};const v=e=>fetch(O(`${e}.json`)).then((t=>t.ok?t.json():Promise.reject(`Unable to fetch ${e}.json`))),f=(e,t)=>c=>fetch(O(`${e}/geojson/${c}`)).then((e=>e.json())).then(t(c));c(17),c(18);const y=e=>{let t=document.createElement("div");return null!=e.aud?t.className="marker-aud":null!=e.img?t.className="marker-img":t.className="marker-pt",t},w=e=>{let t=e.target._content||document.getElementsByClassName("mapboxgl-popup-content")[0];if(null!=t){let e=window.innerWidth/2-t.clientWidth/2;t.style=`transform:translate(${e}px, 0px)`}},N=({place:e,location:t})=>{const c=t.img?O(`${e}/imgLg/${t.img}`):null,n=t.img?O(`${e}/imgSm/${t.img}`):null,s=t.label||"";return Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:"labels",children:[Object(r.jsx)($,{location:t}),Object(r.jsx)(k,{date:t.date})]}),Object(r.jsx)("div",{className:"center",children:Object(r.jsx)("h3",{children:s})}),Object(r.jsx)(P,{srcLg:c,srcSm:n,label:s}),Object(r.jsx)(L,{place:e,src:t.aud})]})},$=({location:e})=>{const t=e.loc.lat.toFixed(4),c=e.loc.lng.toFixed(4),n=`https://www.google.com/maps/search/?api=1&query=${e.loc.lat},${e.loc.lng}`;return Object(r.jsxs)("div",{className:"loc",children:[Object(r.jsxs)("div",{className:"icon link",children:[Object(r.jsx)("span",{className:"material-icons",children:"map"}),Object(r.jsxs)("a",{href:n,target:"_",children:[t,",",c]})]}),Object(r.jsx)("div",{className:"bordr"})]})},k=({date:e})=>null==e?Object(r.jsx)("div",{}):Object(r.jsxs)("div",{className:"icon",children:[Object(r.jsx)("span",{className:"material-icons",children:"schedule"}),e]}),P=({srcLg:e,srcSm:t,label:c})=>Object(r.jsx)("div",{className:"center",children:Object(r.jsx)("a",{id:"scroll",href:e,target:"_blank",rel:"noreferrer",children:Object(r.jsx)(S,{srcLg:e,srcSm:t,label:c})})}),S=({srcLg:e,srcSm:t,label:c})=>null==t||null==e?Object(r.jsx)("div",{}):Object(r.jsx)("img",{className:"bordr",src:t,href:e,alt:c}),L=({place:e,src:t})=>{if(null==t)return Object(r.jsx)("div",{});{const c=O(`${e}/aud/${t}`);return Object(r.jsxs)("audio",{controls:!0,children:[Object(r.jsx)("source",{src:c,type:"audio/mpeg"}),"Your browser does not support audio!"]})}},C=({paintPlace:e,setError:t},c)=>{let n=null;(n=c.split("#")[1])&&e(n).then((()=>{let e=null;(e=document.getElementById(n))&&(e.className="loaded",t(!1))}))};var E={connect:e=>{C(e,window.location.hash),window.onhashchange=()=>{C(e,window.location.hash)}},setHash:e=>window.location.hash=e};let z=c(6);i.a.accessToken="pk.eyJ1IjoiZWRvYXJkc2Nob29uZXIiLCJhIjoiY2lxcHR0dG51MDJoZGZxbmhneTB0aW5oOSJ9.RX4c1qW-bwPCptphF_mr_A";const T=`\xa9 Wes Jackson ${(new Date).getFullYear()} ~ Love and water are never wasted; they are the efflux of our inner nature`,J="#000000",M="#00bcff",A="#ff2592";let W=null;const R=(e,t,c)=>n=>((e,t)=>null==g[e]?v(`${e}/info`).then((c=>(g[e]=c,x.each(c.layers,f(e,t)),Promise.resolve({json:c,paint:!0})))):Promise.resolve({json:g[e],paint:!1}))(n,D(e,n)).then((({json:c,paint:s})=>{_(e,c),s&&(B(e,n,c),t(n))})).catch((e=>c(!0))),_=(e,{zoom:t,locations:c,center:n})=>{const s=z.findWhere(c,{label:n}).loc;e.flyTo({center:[s.lng,s.lat],zoom:t})},B=(e,t,{locations:c})=>z.each(c,((e,t)=>c=>{const n=document.createElement("div");o.a.render(Object(r.jsx)(N,{place:t,location:c}),n);const s=new i.a.Popup({className:"media",closeOnClick:!0,offset:25}).setDOMContent(n);new i.a.Marker(y(c)).setLngLat([c.loc.lng,c.loc.lat]).setPopup(s).addTo(e),s.on("open",w),window.addEventListener("resize",w,!0)})(e,t)),D=(e,t)=>c=>n=>{const s=`layer-${t}-${c}`;e.addSource(s,{type:"geojson",data:n});const l=c.replace(".geojson","").split("-");F(e,s,l),I(e,s,l),Y(e,s)},F=(e,t,c)=>{const n=-1!==c.indexOf("cenote")||-1!==c.indexOf("river"),s=`${t}-points`;e.addLayer({id:s,type:"circle",source:t,paint:{"circle-radius":6,"circle-color":n?"#2592ff":"#ff2592"},filter:["==","$type","Point"]}),e.on("mousemove",s,H(e,s)),e.on("click",s,H(e,s)),e.on("mouseleave",s,(()=>e.fire("closeAllPopups")))},H=(e,t)=>({lngLat:t,features:c})=>{if(0===c.length)return;null!=W&&(W.remove(),W=null);const n=c[0],s="Polygon"===n.geometry.type?t.wrap():n.geometry.coordinates,l=document.createElement("div");l.textContent=n.properties.name,W=new i.a.Popup({offset:[0,-15]}).setLngLat(s).setDOMContent(l).addTo(e),l.parentNode.parentNode.className+=" tip",e.on("closeAllPopups",(()=>{null!=W&&W.remove(),W=null}))},I=(e,t,c)=>{const n=-1!==c.indexOf("track"),s=-1!==c.indexOf("sm");e.addLayer({id:`${t}-lines`,type:"line",source:t,layout:{"line-join":"round","line-cap":"round"},paint:n?q:Z(s),filter:["==","$type","LineString"]})},Y=(e,t)=>{e.addLayer({id:`${t}-outline`,type:"line",source:t,paint:G,filter:["==","$type","Polygon"]});const c=`${t}-area`;e.addLayer({id:c,type:"fill",source:t,paint:{"fill-color":J,"fill-opacity":0},filter:["==","$type","Polygon"]}),e.on("mousemove",c,H(e)),e.on("click",c,H(e)),e.on("mouseleave",c,(()=>e.fire("closeAllPopups")))},Z=e=>({"line-color":M,"line-width":e?1:2,"line-opacity":e?.6:1}),q={"line-color":A,"line-width":2,"line-opacity":.6},G={"line-color":J,"line-width":2,"line-opacity":.25},U=({visible:e})=>e?Object(r.jsx)("div",{id:"center-message",children:Object(r.jsx)("div",{id:"message-container",children:Object(r.jsx)("div",{id:"message",children:"that place does not exist"})})}):Object(r.jsx)("div",{});var X=()=>{const e=Object(n.useRef)(null),[t,c]=Object(n.useState)(null),[s,l]=Object(n.useState)([]),[o,a]=Object(n.useState)(!1),[d,j]=Object(n.useState)(!1),p=e=>R(e,(e=>{j(!1),a(!0),E.setHash(e)}),(()=>j(!0)));return Object(n.useEffect)((()=>{const t=new i.a.Map({container:e.current,style:"mapbox://styles/edoardschooner/cku8yh0id5za818rmtnwt7zzo",attributionControl:!1,center:[-123.0561972,38.9144944],zoom:5}).addControl(new i.a.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})).addControl(new i.a.AttributionControl({compact:!0,customAttribution:T})).addControl(new i.a.FullscreenControl({container:document.querySelector("body")})).addControl(new i.a.NavigationControl,"top-right").once("load",(()=>v("all_rivers").then((({places:e})=>Promise.resolve(x.sortBy(e,"disp")))).then((e=>{l(e),c(t),E.connect({paintPlace:p(t),setError:j})}))));return()=>t.remove()}),[]),Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{id:"my-controls",children:[Object(r.jsx)(m,{paintPlace:p(t),places:s}),Object(r.jsx)(h,{visible:o,colorRiver:M,colorTrack:A})]}),Object(r.jsx)(U,{visible:d}),Object(r.jsx)("div",{className:"map-container",ref:e})]})};var K=function(){return Object(r.jsx)("div",{children:Object(r.jsx)(X,{})})};o.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(K,{})}),document.getElementById("root"))}],[[19,1,2]]]);
//# sourceMappingURL=main.ddd696c1.chunk.js.map