(this.webpackJsonpmultimap=this.webpackJsonpmultimap||[]).push([[0],[,,,,,,,,,,,,function(e,t,c){},function(e,t,c){},function(e,t,c){},,,function(e,t,c){},,,function(e,t,c){},function(e,t,c){"use strict";c.r(t);var n=c(2),r=c.n(n),l=c(5),s=c.n(l),o=(c(12),c(3)),i=c.n(o),a=(c(13),c(14),c(0));let d=c(6);const u=({menuState:e,toggle:t})=>{const c=("open"===e?"Close":"Open")+" map navigation menu.";return Object(a.jsxs)("button",{id:"hamburger",className:e,onClick:t,title:c,"aria-label":c,children:[Object(a.jsx)("span",{}),Object(a.jsx)("span",{}),Object(a.jsx)("span",{}),Object(a.jsx)("span",{})]})},j=({menuState:e,places:t})=>{const c=d.chain(t).keys().map((e=>{const c=t[e];return{id:e,disp:c.disp,className:c.loaded?"loaded":"unloaded"}})).sortBy("disp").value();return Object(a.jsx)("div",{id:"places",className:e,children:Object(a.jsx)("ol",{children:c.map((e=>Object(a.jsx)("div",{children:Object(a.jsx)(p,{id:e.id,className:e.className,disp:e.disp})},e.id)))})})},p=({id:e,className:t,disp:c})=>{const n=`Show map of ${c}.`;return Object(a.jsx)("li",{id:e,className:t,children:Object(a.jsx)("a",{href:"#"+e,title:n,"aria-label":n,children:c})})};var m=({places:e})=>{const[t,c]=Object(n.useState)("loading");return"loading"===t&&d.size(e)>0&&c("open"),Object(a.jsxs)("div",{id:"menu",className:t,children:[Object(a.jsx)(u,{menuState:t,toggle:function(){c("open"===t?"closed":"open")}}),Object(a.jsx)(j,{menuState:t,places:e})]})};c(17);const b=({color:e})=>Object(a.jsx)("svg",{width:"35px",children:Object(a.jsx)("circle",{r:"5",cx:"13",cy:"13",fill:e})}),h=({color:e})=>Object(a.jsx)("svg",{width:"35px",children:Object(a.jsx)("line",{x1:"0",x2:"25",y1:"13",y2:"13",stroke:e})});var O=({available:e,visible:t,colorRiver:c,colorTrack:n})=>{if(t){const t=t=>"item "+(!1===e[t]?"unavailable":"");return Object(a.jsxs)("div",{id:"legend",children:[Object(a.jsxs)("div",{className:t("aud"),children:[Object(a.jsx)("div",{id:"eg-aud",className:"eg-marker"}),Object(a.jsx)("span",{children:"sound"})]}),Object(a.jsxs)("div",{className:t("img"),children:[Object(a.jsx)("div",{id:"eg-img",className:"eg-marker"}),Object(a.jsx)("span",{children:"photo"})]}),Object(a.jsxs)("div",{className:t("water"),children:[Object(a.jsx)(b,{color:c}),Object(a.jsx)("span",{children:"water feature"})]}),Object(a.jsxs)("div",{className:t("human"),children:[Object(a.jsx)(b,{color:n}),Object(a.jsx)("span",{children:"human feature"})]}),Object(a.jsxs)("div",{className:t("other"),children:[Object(a.jsx)(b,{color:"#000000"}),Object(a.jsx)("span",{children:"other feature"})]}),Object(a.jsxs)("div",{className:t("river"),children:[Object(a.jsx)(h,{color:c}),Object(a.jsx)("span",{children:"river"})]}),Object(a.jsxs)("div",{className:t("route"),children:[Object(a.jsx)(h,{color:n}),Object(a.jsx)("span",{children:"my route"})]})]})}return Object(a.jsx)("div",{})},x=c(7),f=c.n(x);c(19);const g=e=>{let t=document.createElement("div");return null!=e.link?(t.className="material-icons marker-link",t.textContent=e.link.icon):null!=e.aud?t.className="marker-aud":null!=e.img&&(t.className="marker-img"),t},v=({s3rsc:e,place:t,location:c,showLocations:n})=>{const r=c.label||"",l=c.link?c.link.src:null,s=c.link?c.link.destination:null,o=c.link?c.link.text:null,i=c.img?e(`${t}/imgLg/${c.img}`):null,d=c.img?e(`${t}/imgSm/${c.img}`):l,u=c.date?c.date.split(" ")[0].replaceAll(":","."):null;return Object(a.jsxs)("div",{children:[Object(a.jsx)(y,{visible:n,location:c}),Object(a.jsx)("h3",{children:r}),Object(a.jsx)("div",{className:"center",children:Object(a.jsxs)("div",{children:[Object(a.jsx)(k,{destination:i,imgSrc:d,label:r,date:u}),Object(a.jsx)(R,{destination:s,text:o})]})}),Object(a.jsx)(N,{s3rsc:e,place:t,src:c.aud}),Object(a.jsx)($,{src:c.video})]})},y=({location:e,visible:t})=>{if(t){const t=e.loc.lat.toFixed(4),c=e.loc.lng.toFixed(4),n=`https://www.google.com/maps/search/?api=1&query=${e.loc.lat},${e.loc.lng}`;return Object(a.jsxs)("div",{className:"icon",children:[Object(a.jsx)("span",{className:"material-icons",children:"map"}),Object(a.jsxs)("a",{href:n,target:"_",children:[t,",",c]})]})}return Object(a.jsx)("div",{})},k=({destination:e,imgSrc:t,label:c,date:n})=>Object(a.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",children:Object(a.jsx)(w,{destination:e,imgSrc:t,label:c,date:n})}),w=({destination:e,imgSrc:t,label:c,date:n})=>{if(null==t)return Object(a.jsx)("div",{});{const r=n;return Object(a.jsxs)("div",{children:[Object(a.jsx)("img",{src:t,href:e,alt:c}),Object(a.jsx)("div",{id:"date",children:r})]})}},N=({s3rsc:e,place:t,src:c})=>{if(null==c)return Object(a.jsx)("div",{});{const n=e(`${t}/aud/${c}`);return Object(a.jsxs)("audio",{controls:!0,children:[Object(a.jsx)("source",{src:n,type:"audio/mpeg"}),"Your browser does not support audio!"]})}},R=({destination:e,text:t})=>null==e||null==t?Object(a.jsx)("div",{}):Object(a.jsx)("a",{className:"link",href:e,target:"_blank",rel:"noreferrer",children:t}),$=({src:e})=>{if(null==e)return Object(a.jsx)("div",{});{const t=`https://www.youtube.com/embed/${e}`;return Object(a.jsx)("iframe",{width:"400",height:"225",src:t,title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0})}};c(20);const S=({options:e,setStyleCb:t})=>{const[c,r]=Object(n.useState)("closed"),[l,s]=Object(n.useState)(e[0].url);Object(n.useEffect)((()=>t(l)),[l]);const o=("open"===c?"Close":"Open")+" layer style menu.";function i(e){return`Set map style to ${e}`}return Object(a.jsxs)("div",{id:"styles",className:c,children:[Object(a.jsx)("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",children:Object(a.jsx)("button",{className:"mapboxgl-ctrl-icon",onClick:function(){r("open"===c?"closed":"open")},title:o,"aria-label":o,children:Object(a.jsx)("span",{className:"material-icons",children:"layers"})})}),Object(a.jsx)("ol",{children:e.map((({name:e,url:t})=>Object(a.jsx)("div",{children:Object(a.jsx)("li",{className:l===t?"selected":"",onClick:()=>s(t),title:i(e),"aria-label":i(e),children:e})},e)))})]})};var C=class{constructor(e){this.container=document.createElement("div"),this.container.className="mapboxgl-ctrl",this.component=Object(a.jsx)(S,{options:e,setStyleCb:e=>this.map.setStyle(e)})}onAdd(e){return this.map=e,this.render(),this.container}onRemove(){this.container.parentNode.removeChild(this.container),this.map=void 0}render(){s.a.render(this.component,this.container)}};let L=c(6),P={},T=e=>"localhost:3000"===window.location.host||!e.local;let M=c(6);const A=({message:e})=>null!=e?Object(a.jsx)("div",{id:"center-message",children:Object(a.jsx)("div",{id:"message-container",children:Object(a.jsx)("div",{id:"message",children:e})})}):Object(a.jsx)("div",{}),B=({html:e})=>null!=e?Object(a.jsx)("div",{id:"desc-container",children:Object(a.jsx)("div",{id:"desc",dangerouslySetInnerHTML:{__html:e}})}):Object(a.jsx)("div",{}),F=({html:e,close:t})=>null!=e?Object(a.jsx)("div",{id:"modal-container",children:Object(a.jsx)("div",{id:"scroller",children:Object(a.jsxs)("div",{id:"modal",children:[Object(a.jsx)("span",{className:"material-icons close",onClick:t,children:"close"}),Object(a.jsx)("div",{id:"content",dangerouslySetInnerHTML:{__html:e.html}})]})})}):Object(a.jsx)("div",{});var W=({config:e})=>{i.a.accessToken=e.map.accessToken;const{s3rsc:t,loadPlace:c,fetchPlaces:r}=(({s3:e})=>{const t=t=>`${e.bucketUrl}/gps/s3/${t}?rev=${(new Date).getTime()}`,c=e=>fetch(t(`${e}.json`)).then((t=>t.ok?t.json():Promise.reject(`Unable to fetch ${e}.json`)));return{s3rsc:t,fetchPlaces:()=>c("all_rivers").then((({places:e})=>{const t=L.chain(e).filter(T).sortBy("disp").map(((e,t)=>L.extend(e,{i:t}))).reduce(((e,{disp:t,id:c,i:n})=>L.extend(e,{[c]:{disp:t,i:n,loaded:!1}})),{}).value();return Promise.resolve(t)})),loadPlace:(e,n)=>null!=e&&null==P[e]?c(`${e}/info`).then((c=>(P[e]=c,L.each(c.layers,(c=>fetch(t(`${e}/geojson/${c}`)).then((e=>e.json())).then(n(c)))),Promise.resolve({json:c,paint:!0})))):Promise.resolve({json:P[e],paint:null==e})}})(e),l=Object(n.useRef)(r),s=Object(n.useRef)(null),o=Object(n.useRef)(e.map.mapStyles),d=Object(n.useRef)(null),u=Object(n.useRef)(null),j=Object(n.useRef)(null),p=Object(n.useRef)(e.map.attribution),b=Object(n.useRef)(e.map.center),h=Object(n.useRef)(e.map.zoom),x=Object(n.useRef)(e.map.showLocations),y=Object(n.useRef)(e.map.geolocation),k=Object(n.useRef)(e.map.circleRadius),w=Object(n.useRef)(e.map.circleStrokeWidth),N=Object(n.useRef)(e.map.circleStrokeColor),R=Object(n.useRef)(e.map.colorWaterMarker),$=Object(n.useRef)(e.map.colorNonWaterMarker),S=Object(n.useRef)(e.map.colorPolyFill),W=Object(n.useRef)(e.map.colorRiver),_=Object(n.useRef)(e.map.colorTrack),J=Object(n.useRef)(e.map.paintPoly),D=Object(n.useRef)(e.map.paintTrack),E=Object(n.useRef)(e.map.paintRiversSm),z=Object(n.useRef)(e.map.paintRiversLg),H=Object(n.useRef)(e.map.legend),I=Object(n.useRef)({}),[U,Y]=Object(n.useState)(null),[Z,q]=Object(n.useState)(!1),[G,X]=Object(n.useState)(null),[K,Q]=Object(n.useState)(null),[V,ee]=Object(n.useState)(null),te=Object(n.useRef)(((e,n)=>{const r=(e,t)=>{const c=-1!==t.indexOf("cenote")||-1!==t.indexOf("river"),n=`${e}-points`;s.current.addLayer({id:n,type:"circle",source:e,paint:{"circle-radius":k.current,"circle-stroke-width":w.current,"circle-stroke-color":N.current,"circle-color":c?R.current:$.current},filter:["==","$type","Point"]}),l(n)},l=e=>{s.current.on("mousemove",e,u),s.current.on("click",e,o),s.current.on("mouseleave",e,(()=>s.current.fire("closeAllPopups")))},o=({lngLat:e,features:t})=>{if(Q(null),0===t.length||"line"===t[0].layer.type)return;let c=t[0].properties.description;if(void 0!==c&&c.length>0){if(0===t.length)return;const n=t[0],r="Point"===n.geometry.type?n.geometry.coordinates:e.wrap();0===c.indexOf("http")&&(c=`<a href='${c}' target='_blank'>${c}</a>`),Q({loc:r,html:c})}else u({lngLat:e,features:t})},u=({lngLat:e,features:t})=>{if(0===t.length)return;null!=d.current&&d.current.remove();const c=t[0],n=c.properties.name||c.properties.Name;if(null==n||0===n.length)return;const r="Point"===c.geometry.type?c.geometry.coordinates:e.wrap(),l=document.createElement("div");l.textContent=n,d.current=new i.a.Popup({offset:[0,-15]}).setLngLat(r).setDOMContent(l).addTo(s.current),l.parentNode.parentNode.className+=" tip hovered",s.current.on("closeAllPopups",(()=>{null!=d.current&&d.current.remove()}))},j=e=>{s.current.addLayer({id:`${e}-outline`,type:"line",source:e,paint:J.current,filter:["==","$type","Polygon"]});const t=`${e}-area`;s.current.addLayer({id:t,type:"fill",source:e,paint:{"fill-color":S.current,"fill-opacity":.1},filter:["==","$type","Polygon"]}),l(t)},p=(e,t)=>{const c=-1!==t.indexOf("track"),n=-1!==t.indexOf("sm"),r=`${e}-lines`;s.current.addLayer({id:r,type:"line",source:e,layout:{"line-join":"round","line-cap":"round"},paint:c?D.current:n?E.current:z.current,filter:["==","$type","LineString"]}),l(r)};return c(e,(e=>t=>c=>{null!=e&&(I.current[t]=()=>{const n=`layer-${e}-${t}`;s.current.addSource(n,{type:"geojson",data:c});const l=t.replace(".geojson","").split("-");r(n,l),j(n),p(n,l)},I.current[t](),s.current.on("style.load",I.current[t]))})(e)).then((({json:c,paint:r})=>{if(r&&(null==e&&null!=n?Y(n):(Y((t=>{const c=t||n;return{...c,[e]:{...c[e],loaded:!0}}})),null!=c&&M.each(c.locations,((e,t,c,n,r)=>l=>{const s=document.createElement("div"),o=new i.a.Popup({className:"media",closeOnClick:!0,offset:25}).setDOMContent(s),d=[l.loc.lng,l.loc.lat];new i.a.Marker(g(l)).setLngLat(d).setPopup(o).addTo(t);const u=f.a.renderToString(Object(a.jsx)(v,{s3rsc:e,place:c,location:l,showLocations:r}));o.on("open",(()=>n({loc:d,html:u})))})(t,s.current,e,Q,x.current)))),null==c)ee(null);else{const e=M.findWhere(c.locations,{label:c.center}).loc;s.current.flyTo({center:[e.lng,e.lat],zoom:c.zoom}),ee(c.desc)}X(null),q(!0)})).catch((e=>{console.log(e),X("That place does not exist.")}))}));return Object(n.useEffect)((()=>{if(null!=K){const e=15,t=2;u.current=new i.a.Popup({offset:[0,1.25*e+t/2]}).setLngLat(K.loc).setHTML(`<svg class='tip selected' width='${2*e}' height='${2*e}'><circle fill='${_.current}' fill-opacity='0.25' stroke-width='${t}' stroke='${_.current}' r='${e}' cx='${e}' cy='${e}'></circle></svg>`).addTo(s.current)}else null!=u.current&&u.current.remove()}),[K]),Object(n.useEffect)((()=>{if(!s.current)return s.current=new i.a.Map({container:j.current,center:b.current,zoom:h.current,attributionControl:!1,projection:"globe",style:o.current[0].url}).addControl(new i.a.AttributionControl({compact:!0,customAttribution:p.current})).addControl(new i.a.FullscreenControl({container:document.querySelector("body")})).addControl(new i.a.NavigationControl,"top-right").once("load",(()=>{l.current().then((e=>{if(null==e)X("Could not fetch places.");else{const t=e=>{let t=window.location.hash.split("#")[1];te.current(t,e)};t(e),window.onhashchange=()=>t()}}))})),y.current&&s.current.addControl(new i.a.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),o.current.length>1&&s.current.addControl(new C(o.current),"top-right"),()=>s.current.remove()}),[]),Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{id:"my-controls",children:[Object(a.jsx)(m,{places:U}),Object(a.jsx)(O,{available:H.current,visible:Z,colorRiver:W.current,colorTrack:_.current})]}),Object(a.jsx)(A,{message:G}),Object(a.jsx)(B,{html:V}),Object(a.jsx)("div",{className:"map-container",ref:j}),Object(a.jsx)(F,{html:K,close:()=>Q(null)})]})};const _={site:{title:"Mel Mitchell-Jackson Adventures"},s3:{bucketUrl:"https://d19ukusntnkj32.cloudfront.net"},map:{accessToken:"pk.eyJ1IjoiZWRvYXJkc2Nob29uZXIiLCJhIjoiY2lxcHR0dG51MDJoZGZxbmhneTB0aW5oOSJ9.RX4c1qW-bwPCptphF_mr_A",mapStyles:[{name:"Persistent Bloom",url:"mapbox://styles/edoardschooner/clwr7skwh00xr01pp5luy4z3l"}],showLocations:!1,center:[-119.509444,37.229722],zoom:5,attribution:`\xa9 Wes Jackson ${(new Date).getFullYear()} ~ Love and water are never wasted; they are the efflux of our inner nature`,geolocation:!1,circleRadius:12,circleStrokeWidth:2,circleStrokeColor:"#ffffff",colorWaterMarker:"#4A4672",colorNonWaterMarker:"#B04D5B",colorPolyFill:"#CF664F",colorRiver:"#4A4672",colorTrack:"#B04D5B",paintPoly:{"line-color":"#CF664F","line-width":1,"line-opacity":.85},paintTrack:{"line-color":"#B04D5B","line-width":2,"line-opacity":.6},paintRiversSm:{"line-color":"#4A4672","line-width":1,"line-opacity":.6},paintRiversLg:{"line-color":"#4A4672","line-width":2,"line-opacity":1},legend:{aud:!1,img:!0,water:!0,human:!1,other:!1,river:!0,route:!0}}};var J=function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("title",{children:_.site.title}),Object(a.jsx)(W,{config:_})]})};s.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(J,{})}),document.getElementById("root"))}],[[21,1,2]]]);
//# sourceMappingURL=main.fa2e8d1b.chunk.js.map